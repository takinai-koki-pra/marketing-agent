# 🤖 ペルソナベースAIエージェント システム要件定義書

---

## 1. 文書情報
| 項目 | 内容 |
|------|------|
| 文書名 | ペルソナベースAIエージェント システム要件定義書 |
| バージョン | 1.0 |
| 作成日 | 2025年1月28日 |
| 最終更新日 | 2025年1月28日 |
| 作成者 | 開発チーム |

---

## 2. プロジェクト概要

### 2.1 プロジェクト名
**ペルソナベースAIエージェント - AI駆動型企画案生成システム**

### 2.2 対象システム
- **業務アプリケーション**: ペルソナベース企画案生成・検討支援自動化システム
- **対象用途**: 企画立案・マーケティング戦略・商品開発・ユーザーリサーチ
- **技術スタック**: Python + Cursor AI + OpenAI API + Markdown

### 2.3 プロジェクトの目的・背景
- **背景**: 企画立案において多角的な視点が必要だが、実際の多様な意見を集めることが困難
- **解決したい課題**: 
  - 単一視点での企画立案による偏り
  - 多様なターゲット層の意見収集コストの高さ
  - 企画案の客観的評価・改善プロセスの不足
- **期待する効果**: 
  - 多角的視点による質の高い企画案生成
  - 効率的な企画立案プロセスの確立
  - データドリブンな意思決定支援

### 2.4 開発方針
- **AI最適化設計**: Cursor専用プロンプトテンプレートによる効率的な開発
- **自動化重視**: 手作業部分の最小化と品質管理の自動化
- **データドリブン設計**: リサーチデータと市場データに基づくペルソナ生成
- **段階的実行**: 明確なSTEP分割による確実な成果物生成

### 2.5 対象企業・ユーザー
| 対象 | 詳細 |
|------|------|
| **対象企業** | 企画立案・マーケティング戦略を必要とする企業 |
| **業界** | 汎用（業界特化テンプレート提供可能） |
| **企業規模** | 中小企業〜大企業 |
| **利用者** | 企画担当者、マーケティング担当者、経営陣 |

### 2.6 ステークホルダー
- **企画・マーケティング部門**: 日常的な利用者、要件フィードバック
- **経営陣・意思決定者**: システム投資判断、戦略的活用方針決定
- **開発チーム**: システム開発・改善・保守

### 2.7 プロジェクトスコープ
- **対象範囲**: 
  - ペルソナ生成・分析レポート自動生成
  - 企画案生成・検討プロセス
  - 多角的視点による企画評価
  - 進捗管理・品質保証システム
- **対象外範囲**: 
  - Webアプリケーション開発
  - 大規模データベース構築
  - リアルタイム分析機能（将来拡張予定）

---

## 3. 現状分析

### 3.1 現状業務フロー
```
1. 市場調査・ユーザーリサーチの実施
2. 調査結果の分析・まとめ
3. 企画案の初期検討（単一チーム視点）
4. 社内での意見収集・検討
5. 企画案の修正・改善
6. 最終的な企画案決定
```

### 3.2 現状の課題
- **業務プロセス**: 
  - 企画立案に時間がかかる（調査→分析→企画の繰り返し）
  - 多様な視点の収集が困難
  - 企画案の客観的評価基準が不明確
- **データ管理**: 
  - リサーチデータの活用が一時的・断片的
  - 過去の調査結果の再利用が困難
  - データからインサイトを得るプロセスが属人的
- **企画・アイデア生成**: 
  - 同じようなアイデアの繰り返し
  - ターゲット層の多様性を考慮した企画立案が困難
  - 企画案の改善プロセスが非効率的

---

## 4. 要求仕様

### 4.1 必須実装機能

#### 4.1.1 プロジェクト管理機能
- **目的**: 企画案生成プロジェクトの一元管理
- **機能概要**: 日付別プロジェクトの自動生成・管理
- **詳細機能**:
  - `setup-project.py`による自動プロジェクト作成
  - テンプレートファイルの自動配置
  - ディレクトリ構造の標準化
  - 進捗確認・TODOマーカー管理システム

#### 4.1.2 データ分析・ペルソナ生成機能
- **目的**: リサーチデータからの多様なペルソナ自動生成
- **機能概要**: データ分析に基づく特性の異なるペルソナの作成
- **詳細機能**:
  - リサーチデータの分析・統計処理
  - ペルソナセグメント分析レポート生成
  - ペルソナプロファイル詳細レポート（`01_persona-analysis.md`）出力
  - 複数ペルソナの特性比較分析
  - ペルソナ特性データベース構築

#### 4.1.3 ペルソナベース企画検討機能
- **目的**: 複数ペルソナ視点による企画案の生成・検討
- **機能概要**: 多角的視点での企画立案支援
- **詳細機能**:
  - 企画テーマ・目的の明確化
  - ペルソナ毎の意見・提案生成
  - 企画検討プロセスレポート（`02_planning-session.md`）出力
  - ペルソナ間の意見統合・まとめ
  - 企画案の多角的評価

#### 4.1.4 企画案統合・評価機能
- **目的**: ペルソナ検討結果の統合と客観的評価
- **機能概要**: 総合的な企画案策定と評価分析
- **詳細機能**:
  - 複数ペルソナ意見の統合分析
  - 企画案の実現可能性評価
  - リスク・課題分析
  - 企画案評価レポート（`03_plan-evaluation.md`）出力
  - 改善提案・次ステップ提示

#### 4.1.5 最終企画書生成機能
- **目的**: プレゼンテーション可能な企画書の作成
- **機能概要**: 検討プロセス全体を統合した企画書作成
- **詳細機能**:
  - 企画書構成の自動設計
  - ペルソナ分析結果の組み込み
  - 企画案詳細仕様書作成
  - 最終企画書（`04_final-proposal.md`）出力
  - 完了レポート（`05_completion-report.md`）生成

#### 4.1.6 リサーチデータ自動取得機能
- **目的**: 日本の政府統計データを活用した統計的に正確なペルソナ生成
- **機能概要**: e-Stat API（総務省統計局）から最新の統計データを自動取得・分析
- **詳細機能**:
  - **政府統計データ取得**: e-Stat API（総務省統計局）から人口統計・家計調査・労働力調査データ取得
    - **人口統計**: 年齢・性別・職業・収入・地域別の詳細人口データ
    - **家計調査**: 消費支出・ライフスタイル・購買行動パターン
    - **労働力調査**: 就業状況・働き方・職業分布
    - **住宅・土地統計**: 居住環境・地域特性データ
    - **コスト**: **完全無料**（ユーザー登録のみ）
  - **統計データ分析**: 取得データの自動分析・クレンジング・統計処理
  - **ペルソナ生成**: 統計的裏付けのある現実的なペルソナプロファイル作成
  - **データ可視化**: 統計結果のグラフ・チャート自動生成
  - **定期更新**: 政府統計の更新に合わせたデータ自動取得・更新機能

#### 4.1.7 プレゼンテーション資料生成機能
- **目的**: 即座に発表可能なプレゼンテーション資料の作成
- **機能概要**: MARPを活用したPowerPoint/HTML形式での出力
- **詳細機能**:
  - 企画書内容のプレゼンテーション最適化
  - MARPテンプレートによる美しいスライド生成
  - PowerPoint形式（.pptx）での出力
  - HTML形式での出力（ブラウザプレゼン対応）
  - プレゼン用資料一式（`presentation-files/`）生成

### 4.2 推奨実装機能

#### 4.2.1 品質管理・進捗確認機能
- **目的**: プロジェクト品質と進捗の可視化
- **機能概要**: 自動品質チェックと進捗管理
- **詳細機能**:
  - `check-progress.py`による進捗確認
  - TODOマーカー残存チェック
  - 完了率の算出・表示
  - 品質基準の自動チェック

#### 4.2.2 プロンプト最適化機能
- **目的**: Cursor AIでの効率的な実行支援
- **機能概要**: 最適化されたプロンプトテンプレート提供
- **詳細機能**:
  - クイックスタートプロンプト（`quick-start.md`）
  - 段階別実行プロンプト
  - 品質チェック用プロンプト
  - トラブルシューティングガイド

#### 4.2.3 ナレッジベース管理機能
- **目的**: 業界・企業特化ナレッジの効率的活用
- **機能概要**: 構造化されたナレッジデータの管理
- **詳細機能**:
  - 業界別リサーチデータテンプレート
  - ペルソナ特性定義ライブラリ
  - 企画カテゴリ別評価基準
  - ナレッジの更新・拡張機能

#### 4.2.4 自動化ツール群
- **目的**: 手作業の最小化と効率化
- **機能概要**: Python自動化スクリプト群
- **詳細機能**:
  - プロジェクトセットアップ自動化
  - データ分析の自動実行
  - レポート生成の自動化
  - プレゼンテーション自動生成（MARP連携）
  - 結果の自動検証・品質チェック

#### 4.2.5 API連携管理機能
- **目的**: 複数API連携の効率的管理と障害対応
- **機能概要**: APIキー管理、レート制限対応、エラーハンドリング
- **詳細機能**:
  - **APIキー管理**: 環境変数によるセキュアなAPIキー管理
  - **レート制限対応**: API利用制限の自動監視・制御
  - **エラーハンドリング**: API障害時の代替データ利用・リトライ機能
  - **使用量監視**: API利用状況の可視化・コスト管理
  - **データキャッシュ**: 取得データの一時保存・再利用機能

#### 4.2.6 プレゼンテーションテンプレート機能
- **目的**: 美しく統一されたプレゼンテーション資料の生成
- **機能概要**: 業界・用途別のMARPテンプレート提供
- **詳細機能**:
  - 企画提案用テンプレート
  - 経営陣向け要約テンプレート
  - 詳細分析用テンプレート
  - カスタムテーマ・デザイン機能

### 4.3 ペルソナ特性定義

#### 4.3.1 基本属性
- **人口統計学的属性**: 年齢、性別、職業、収入、居住地
- **心理学的属性**: 価値観、ライフスタイル、パーソナリティ
- **行動属性**: 消費行動、メディア接触、意思決定パターン

#### 4.3.2 コミュニケーション特性
- **言語特性**: 語彙レベル、文体、専門用語使用頻度
- **反応パターン**: 質問への回答傾向、興味関心の示し方
- **意見形成**: 論理的思考 vs 感情的判断、リスク許容度

#### 4.3.3 企画評価観点
- **評価基準**: コスト重視 vs 効果重視、短期 vs 長期視点
- **意思決定要因**: 合理性、感情、社会的影響、過去経験
- **関心領域**: 業界知識、トレンド感度、イノベーション受容度

### 4.4 出力成果物仕様

#### 4.4.1 必須出力ファイル
| ファイル名 | 内容 | 形式 |
|-----------|------|------|
| `01_persona-analysis.md` | ペルソナ分析レポート | Markdown |
| `02_planning-session.md` | 企画検討プロセス記録 | Markdown |
| `03_plan-evaluation.md` | 企画案評価・分析 | Markdown |
| `04_final-proposal.md` | 最終企画書 | Markdown |
| `05_completion-report.md` | プロジェクト完了レポート | Markdown |
| `persona-data-YYYYMMDD.json` | ペルソナ分析データ | JSON |

#### 4.4.2 プレゼンテーション成果物
| ファイル名 | 内容 | 形式 |
|-----------|------|------|
| `presentation-files/presentation.md` | MARP用プレゼンMarkdown | Markdown |
| `presentation-files/slides.pptx` | PowerPointプレゼン資料 | PowerPoint |
| `presentation-files/slides.html` | HTMLプレゼン資料 | HTML |
| `presentation-files/assets/` | 画像・チャート素材 | PNG/SVG |
| `presentation-files/README.md` | プレゼン実行ガイド | Markdown |

#### 4.4.3 データ要件

##### 入力データ形式
- **リサーチデータ**: アンケート結果、インタビュー記録、行動ログ
- **市場データ**: 統計情報、トレンドデータ、競合分析結果
- **外部データ**: SNS分析、Web行動データ、購買データ

##### データ品質要件
- **完全性**: 必須項目の欠損率5%以下
- **精度**: データ入力エラー率1%以下
- **一貫性**: データ形式・定義の統一
- **最新性**: データ更新頻度の明示

### 4.5 品質要件

#### 4.5.1 品質管理システム
- **TODOマーカーシステム**: 置換対象箇所の明確化
- **段階的検証**: 各STEPでの前工程結果参照
- **完全性チェック**: 全TODOマーカーの更新確認
- **実用性保証**: 即座に使用可能な成果物品質

#### 4.5.2 品質基準
- **ペルソナ分析**: 主要ペルソナ5-7体の詳細分析必須
- **企画案品質**: 実現可能性・具体性スコア80%以上
- **レポート品質**: 構造化・論理的整合性の確保
- **内容品質**: ペルソナ特性の明確な反映

---

## 5. 技術要件

### 5.1 技術スタック
- **主要言語**: Python 3.8+
- **AI開発環境**: Cursor（必須）
- **外部API**: OpenAI API（ペルソナ生成・対話用）
- **プレゼンテーション**: MARP（Markdown→PowerPoint/HTML変換）
- **データ形式**: Markdown + JSON + CSV
- **分析ライブラリ**: pandas + numpy + scikit-learn
- **OS環境**: Windows 10/11（PowerShell対応）

### 5.2 依存関係・ライブラリ
```python
# Python依存関係（requirements.txt）
openai==1.3.0
pandas==2.1.0
numpy==1.24.0
scikit-learn==1.3.0
python-dotenv==1.0.0
requests==2.31.0

# オプション（必要に応じて追加）
# matplotlib==3.7.0      # データ可視化
# seaborn==0.12.0        # 統計可視化
# plotly==5.15.0         # インタラクティブグラフ
```

```json
// Node.js依存関係（package.json）- MARP用
{
  "devDependencies": {
    "@marp-team/marp-cli": "^3.4.0",
    "@marp-team/marp-core": "^3.9.0"
  }
}
```

### 5.3 システム構成
```
004_persona_agent/
├── 📋 prompts/              # プロンプトテンプレート
│   ├── quick-start.md       # クイックスタート
│   ├── persona-analysis.md  # ペルソナ分析用
│   ├── planning-session.md  # 企画検討用
│   ├── plan-evaluation.md   # 企画評価用
│   └── presentation.md      # プレゼンテーション生成用
├── 📚 knowledge/            # ナレッジベース
│   ├── persona-templates.md # ペルソナテンプレート
│   ├── industry-data.md     # 業界データ
│   ├── evaluation-criteria.md # 評価基準
│   └── marp-themes/         # MARPテーマ・テンプレート
│       ├── corporate.css    # 企業向けテーマ
│       ├── modern.css       # モダンテーマ
│       └── minimal.css      # ミニマルテーマ
├── ⚙️ workflows/            # 自動化ツール
│   ├── main.md              # メインワークフロー定義
│   ├── setup-project.py     # プロジェクト自動セットアップ
│   ├── check-progress.py    # 進捗確認ツール
│   ├── persona-analyzer.py  # ペルソナ分析ツール
│   ├── presentation-generator.py # プレゼンテーション生成ツール
│   ├── requirements.txt     # Python依存関係
│   └── package.json         # Node.js依存関係（MARP用）
└── 📂 outputs/              # 成果物格納
    ├── templates/           # テンプレートファイル
    └── YYYYMMDD/           # 日付別プロジェクト
        ├── 01_persona-analysis.md
        ├── 02_planning-session.md
        ├── 03_plan-evaluation.md
        ├── 04_final-proposal.md
        ├── 05_completion-report.md
        ├── persona-data-YYYYMMDD.json
        ├── presentation-files/
        │   ├── presentation.md
        │   ├── slides.pptx
        │   ├── slides.html
        │   ├── assets/
        │   └── README.md
        └── research-data/
            ├── input-data.csv
            ├── analysis-results.json
            └── README.md
```

### 5.4 パフォーマンス要件
- **プロジェクト作成時間**: 5分以内で完全セットアップ
- **各STEP実行時間**: 15-30分以内（AIによる生成時間）
- **ペルソナ分析処理**: 10分以内での完了
- **プレゼンテーション生成**: 5分以内でPowerPoint/HTML出力完了
- **データ処理量**: CSV 10,000行程度、テキストデータ 5MB程度

### 5.5 環境要件
- **開発環境**: Windows 10/11 + PowerShell
- **必須ツール**: Cursor、Python 3.8+、Node.js 16+、Git
- **推奨ツール**: VS Code（サブエディタ）、Excel（データ確認用）、PowerPoint（プレゼン確認用）
- **外部API**: OpenAI APIキー（ペルソナ生成・対話用、必須）

---

## 6. 運用要件

### 6.1 使用方法・ワークフロー

#### 6.1.1 クイックスタート（推奨）
```bash
# 1. プロジェクト作成
python workflows/setup-project.py

# 2. Cursorでプロンプト実行
# @prompts/quick-start.md の内容をコピーして実行

# 3. プレゼンテーション生成
python workflows/presentation-generator.py
```

#### 6.1.2 段階的実行
```bash
# 1. プロジェクト準備
python workflows/setup-project.py --date 20250625

# 2. 各STEPを順次実行
# @workflows/main.md を参照しながら進める

# 3. プレゼンテーション生成
python workflows/presentation-generator.py --date 20250625
```

#### 6.1.3 進捗確認付き実行
```bash
# 進捗確認
python workflows/check-progress.py

# TODOマーカー残存確認
findstr /n "TODO" outputs\YYYYMMDD\*.md
```

### 6.2 品質保証プロセス
- **完了条件チェック**: 各STEPの完了条件確認
- **TODOマーカー管理**: 全マーカーの更新確認
- **成果物検証**: レポート構造・内容の整合性チェック
- **最終品質確認**: チェックリストによる総合確認

### 6.3 トラブルシューティング
- **プロジェクト作成エラー**: ディレクトリ権限確認
- **OpenAI API エラー**: APIキー設定確認
- **データ分析エラー**: 入力データ形式確認
- **進捗確認エラー**: ファイル存在確認
- **MARP エラー**: Node.js・MARPインストール確認
- **プレゼンテーション生成エラー**: テンプレートファイル・パス確認

---

## 7. 成功指標・KPI

### 7.1 プロジェクト完了の目安
- [ ] 全5つのSTEPファイルが作成済み
- [ ] TODOマーカーが0個（完全に更新済み）
- [ ] ペルソナ分析が論理的・具体的に完成
- [ ] 企画案が実現可能性80%以上で提示済み

### 7.2 品質チェックリスト
- [ ] ペルソナ特性が明確に表現されている
- [ ] 企画案がペルソナ特性を反映している
- [ ] 評価基準が客観的・論理的である
- [ ] レポート構造が統一されている
- [ ] プレゼンテーション資料が正常に生成される
- [ ] PowerPoint/HTML形式で開ける

### 7.3 業務効率化指標
- **企画立案時間**: 従来比50%以上短縮
- **多角的視点数**: 5-7ペルソナからの意見収集
- **品質の一貫性**: 標準プロセスによる品質向上
- **再利用性**: ナレッジベース・テンプレートの活用率

---

## 8. 制約事項・前提条件

### 8.1 技術的制約
- **OS環境**: Windows専用（PowerShell環境必須）
- **エディタ**: Cursor必須（AI機能活用のため）
- **外部API**: OpenAI API依存（ペルソナ生成・企画検討用）
- **インターネット**: 常時接続必須（API利用のため）

### 8.2 業務的制約
- **対象範囲**: 企画立案支援（実装フェーズは対象外）
- **データ形式**: CSV・JSON・Markdownテキストベース
- **言語**: 日本語のみ対応
- **運用時間**: 平日日中の利用想定

### 8.3 データ制約
- **入力データ**: リサーチデータの事前準備が必要
- **ペルソナ数**: 5-10体程度を推奨（処理速度・品質バランス）
- **データ量**: CSV 10,000行、テキスト 5MB以内推奨

---

## 9. 将来展望・拡張計画

### 9.1 機能拡張
- [ ] 他業界テンプレートの追加（IT、金融、製造業等）
- [ ] リアルタイムペルソナ対話機能
- [ ] より高度なデータ分析・機械学習機能
- [ ] 多言語対応（英語版テンプレート）
- [ ] 動的チャート・グラフ自動生成機能
- [ ] 音声ナレーション付きプレゼンテーション

### 9.2 技術拡張
- [ ] Web UIの実装（現在はCursor専用）
- [ ] データベース連携機能
- [ ] 外部API連携（市場データ、SNS分析等）
- [ ] 音声・動画による対話機能

### 9.3 事業展開
- [ ] SaaS型サービスとしての提供
- [ ] 他企業向けカスタマイズサービス
- [ ] 企画コンサルタント向けツール提供

---

## 10. バージョン管理・更新履歴

### 10.1 現在バージョン
- **バージョン**: v1.0
- **リリース日**: 2025年1月28日
- **対応分野**: 汎用企画立案
- **対応データ**: CSV・JSON・テキスト

### 10.2 今後の更新予定
- **v1.1**: 業界特化テンプレート追加（2025年Q2予定）
- **v2.0**: Web UI実装（2025年Q3予定）
- **v2.1**: リアルタイム対話機能追加（2025年Q4予定）

---

**🎯 最終目標**: リサーチデータから多様なペルソナを生成し、多角的視点による質の高い企画案を効率的に立案できるプロンプトベースワークフローシステムの構築
